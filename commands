msfupdate

search name:Windows type:exploit

info /*THING YOU WANT TO GET INFO ON */
/*SO IF I AM ABLE TO UNDERSTAND IT CORRECTLY NMAP SENDS PROBE PACKETS TO HOSTS TO DETERMINE IF THEY ARE UP OR DOWN, WHAT SSERVICES THEY 
ARE RUNNING AND OTHER CHARACTERSTICS ABOUT THE HOST*/

nmap -sO
/*PROVIDES INFO ON THE SUPPORTED IP PROTOCOLS  RATHER THAN LISTENING ON THE PORTS*/

nmap -A
/*OS AND VERSION DETECTION SCRIPT SCANNING AND TRACEROUTE*/

nmap -T(1 through 5)
/*related to the speed of execution*/

/*PORT SCANNING : NMAP STARTED OUT AS A PORT SCANNER AND THAT STILL REMAINS ITS CORE FUNCTIONALITIES. SCANS 1000 PORTS ON TCP
DIVIDES THEM INTO FOLLOWING STATES 6 STATES, DOESN'T GIVE THE ACTUAL STATE OF THE PORTS BUT SHOWS HOW NMAP SEES THEM


OPEN :-TARGET IS ACCEPTING CONNECTIONS OVER TCP,UDP AND SCTP(PROTOCOL FOR TRANSFERRING MULTIPLE STREAMS OF DATA AT THE SAME TIME)

CLOSED:- PORT IS ACCESSIBLE BUT NO APPLICATION IS CURRENTLY LISTENING ON IT
FILTERED :- CAN'T DETERMINE WHETHER THE PORT IS OPEN OR CLOSED BECAUSE PACKET FILTERING PREVENTS ITS PROBE FROM REACHING THE PORT
, FRUSTRATE ATTACKERS THE MOST BECAUSE THEY PROVIDE SO LITTLE INFO, DOESN'T 
RESPOND TO THE NMAP PROBES, SLOWS THE SCAN DOWN AS PROBES HAVE TO SENT MULTIPLE TIMES JUST TO ENSURE THAT THE PACKETS WERE NOT DROPPED
DUE TO CONGESTION, DEDICATED FIREWALLS, HOSTBASED FIREWALLS , ROUTER RULES,
SOMETIMES RESPOND WITH ICMP ERROR MESSAGES SUCH AS TYPE 3 CODE 13


UNFILTERED
OPEN|FILTERED 
CLOSED|FILTERED



*/

-------------------------------------------------------------TYPES OF SCANS--------------------------------------------------
TWO MOST COMMON TYPES ARE;
1.TCP CONNECT() SCAN   
-sT
DERIVES ITS NAME FROM THE SYSTEM CALL IN UNIX connect() WHICH IS USED TO FORM CONNECTION, IF A CONNECT() SUCCEDS A CONNECTION IS MADE
OTHERWISE NOT ,IN THE END ALL THE PORTS WITH WHICH THE CONNECTION WAS MADE WILL BE LISTED AS OPEN AND THE REST AS CLOSED 
TARGET SYSTEM WITH A FIREWALL OR IDS WILL ALWAYS TRIGGER WARNING 
WITH MODERN FIREWALLS ATTEMPT TO ESTABLISH A CONNECTION WITH A BLOCKED PORT WILL BE LOGGED ALONG WITH THE IP ADDRESS OF THE ATTACKER
FOR THIS REASON SYN SCAN WAS DEVELOPED

2.SYN SCAN(HALF-OPEN SCAN OR STEALTH SCAN)
-sS
USUAL THREE WAY HANDSHAKE SHIT
ATTACKER SENDS SYN PACKET
IF THE PORT IS OPEN SYN+ACK IS SENT TO WHICH ATTACKER SENDS RST WHICH TEARS DOWN THE CONNECTION AND PREVENTS BEING LOGGED
IF THE PORT IS CLOSED A RST IS SENT BY CLIENT
IF THE PORT IS FILTERED THE PACKET WILL BE DROPPED AND NO RESPONSE IS SENT BACK, REQUIRE FURTHER PROBING SINCE THEY COULD BE SUBJECT TO 
FIREWALL RULES WHICH OPENS THEM FOR CERTAIN IP AND CLOSED TO OTHERS

MODERN FIREWALLS AND IDS CAN DETECT SYN SCANS BUT USING A COMBINATION OF TIMING AND OTHER OPTIONS OF NMAP IT IS POSSIBLE TO CREATE
VIRTUALLY UNDETECTABLE SCAN

------------------------------------------------------------------------------------------------------------------------------
BASIC IDEA BEHIND THE FOLLOWING SCANS IS THAT A CLOSED PORT SHOULD RESPOND WITH A RST WHEREAS OPEN PORT SHOULD JUST DROP THEM(AS PORTS 
ARE LISTENING FOR PACKETS WITH SYN SET), THIS WAY ATTACKER NEVER BECOMES PART OF THE CONNECTION AND NEED NOT SEND A SYN PACKET WHICH 
IS WHAT MOST IDS LOOK FOR. 
FIN FLAG SENDS PACKET WITH FIN FLAG SET
NULL PACKET DOESN'T SET ANY FLAG
XMAS SETS FIN, URG AND PUSH FLAGS

1.FIN SCAN
-sF
2.NULL SCAN
-sN
3.XMAS TREE SCAN
-sX

----------------------------------PING SCAN(  -sP  )-------------------------------------------------

ATTACKER PINGS THE VICTIM TO SEE IF IT IS ONLINE AND DOESN'T CARE ABOUT WHICH PORTS ARE OPEN
4 METHODS EXIST WITHIN NMAP FOR PING
1.ICMP ECHO REQUEST METHOD:
ATTACKER SENDS ICMP REQUEST PACKET TO THE TARGET ,IF ICMPECHO REPLY IS RECEIVED SYSTEM IS UP AND THE ICMP PACKETS ARE NOT BLOCKED
IF REPLY IS NOT RECEIVED USE TCP PING TO DETERMINE IF ICMP IS BLOCKED OTR THE HOST IS REALLY DOWN
IN TCP PING YOU SEND EITHER SYN OR ACK IF SYN+ACK OR RST IS RECEIVED HOST IS UP OTHERWISE THE PORT IS FILTERED AND ISN'T RESPONDING TO 
ANYTHING
IN ROOT MODE ICMP AND ACK ARE DEFAULT ,IN NON-ROOT MODE CONNECT() METHOD IS USED TO ESTABLISH THE CONNECTION AND TEARS IT DOWN AS SOON AS
THE ACK IS SENT AND THE HANDSHAKE IS COMPLETED
ICMP SCAN TYPE CAN BE DISABLED USING -P0

--------------------------------------UDP SCAN(-sU)---------------------------------------------------------
SCANS ALL THE 65535 UDP PORTS BY SENDING 0 BYTE UDP PACKETS IF ICMP PORT UNREACHABLE IS RECEIVED IT IMPLIES PORT IS CLOSED ELSE IT 
IS ASSUMED TO BE OPEN
ONE PROBLEM IS THAT IF A FIREWALL BLOCKS ICMP PORT UNREACHABLE FROM GOING OUT IT IS ASSUMED TO BE OPEN AND THESE KIND OF FALSE POSITIVES 
ARE HARD TO DISTINGUISH
ANOTHER THING IS THAT MOST OS LIMIT THE NUMBER OF ICMP HOST UNREACHABLE PACKETS THUS MAKING THE SCAN SLOW
WINDOWS DOESN'T HAVE LIMIT SO ALL THE PORTS CAN BE SCANNED WITHIN A SMALL AMOUNT OF TIME
ISN'T REALLY USEFUL BUT REVEALS INFO ABOUT THE SERVICES AND TROJANS THAT RELY ON UDP
SUCH AS SNMP,NFS, BACK ORIFICE TROJAN
ISN'T GENERALLY USED UNLESS OTHERWISE SUGGESTED BY THE INFO GATHERING PHASE
























